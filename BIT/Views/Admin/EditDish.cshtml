@using BIT.DataStuff;
@using BIT.Interfaces;
@inject IAllDishes DishBase;
@{
    Layout = "_LayoutAdmin";
}

<style>
    #partial-load {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        max-height: 80vh;
        overflow-y: auto;
        background-color: white;
        border: 1px solid #ccc;
        padding: 10px;
        display: none;
        z-index: 999; /* Додайте z-index, щоб мати вищий зрівень ніж інші елементи на сторінці */
    }

</style>

@foreach (var dish in DishBase.Dishes)
{
    <div>
        <!-- Показати дані рядка -->
        <span>@dish.Name</span>
        <!-- Додати кнопку для видалення -->
        <form asp-action="Edit" method="post">
            <input type="hidden" name="dishId" value="@dish.Id" />
            <button type="submit" class="btn btn-success edit-btn">Редагувати</button>
        </form>
    </div>
}


<div id="partial-load"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/3.1.12/signalr.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<script>
    $(document).ready(function () {
        var partialLoadContainer = $('#partial-load');

        // Додано обробник кліку для кнопки "Замовити"
        $(".edit-btn").click(function () {
            var form = $(this).closest('form');
            var dishId = form.find('input[name="dishId"]').val();

            // Вивести часткове представлення замовлення на сторінку
            $.ajax({
                url: form.attr('action'),
                type: form.attr('method'),
                data: { dishId: dishId },
                success: function (partialView) {
                    partialLoadContainer.html(partialView).fadeIn();
                }
            });
        });

        // Додано обробник кліку для закриття часткового представлення
        $(document).on('click', '#partial-load', function (e) {
            if ($(e.target).is('#partial-load')) {
                partialLoadContainer.fadeOut();
            }
        });
    });
</script>
