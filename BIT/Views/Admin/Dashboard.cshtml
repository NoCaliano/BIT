@using BIT.DataStuff
@using BIT.Interfaces
@inject IAllOrders OrderBase

@{
    Layout = "_LayoutAdmin";
    int displayedOrdersCount = 0;
}

<link rel="stylesheet" href="~/css/Admin/Dashboard.css" asp-append-version="true" />

<div style="max-width: 800px; max-height: 200px; margin: 0 auto;">
    <!-- Перший графік -->
    <canvas id="MyChart1" style="max-width: 400px; max-height: 200px; float: left;"></canvas>

    <!-- Другий графік -->
    <canvas id="MyChart2" style="max-width: 400px; max-height: 200px; float: right;"></canvas>
</div>



<div class="row">
    <div class="col-md-12">
        <table class="table">
            <thead>
                <tr>
                    <th scope="col">Продукт</th>
                    <th scope="col">Дата замовлення</th>
                    <th scope="col">Метод оплати</th>
                    <th scope="col">Кур'єр</th>
                    <!-- Додайте інші заголовки за необхідності -->
                </tr>
            </thead>
            <tbody>
                @foreach (var order in OrderBase.Orders)
                {
                    if (displayedOrdersCount < 10 && order.OrderDate >= DateTime.Now.AddDays(-2))
                    {
                        <tr>
                            <td>@order.ProductName</td>
                            <td>@order.OrderDate.ToString("yyyy-MM-dd HH:mm:ss")</td>
                            <td>@order.PaymentMethod</td>
                            <td>@order.Courier</td>
                            <!-- Додайте інші комірки з даними за необхідності -->
                        </tr>
                        displayedOrdersCount++;
                    }
                }
            </tbody>
        </table>
    </div>
</div>
































<!-- Скрипти для завантаження та відображення графіків -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

<!-- Скрипт для першого графіка -->
<script type="text/javascript">
    $(document).ready(function () {
        // Завантаження даних для першого графіка
        $.ajax({
            type: "POST",
            url: "/ChartData/MostSellChart",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                var _chartLabels = data[0];
                var _chartData = data[1];

                var barColor = ["red", "green", "gold", "blue"];

                new Chart("MyChart1", {
                    type: "pie",
                    data: {
                        labels: _chartLabels,
                        datasets: [{
                            backgroundColor: barColor,
                            data: _chartData
                        }]
                    }
                });
            },
            error: OnError
        });

        function OnError(err) {
            console.error(err);
        }
    });
</script>

<!-- Скрипт для другого графіка -->
<script type="text/javascript">
    $(document).ready(function () {
        // Завантаження даних для другого графіка
        $.ajax({
            type: "POST",
            url: "/ChartData/PriceChart",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                var _chartLabels = data[0];
                var _chartData = data[1];

                var barColor = ["blue", "green", "red"];

                new Chart("MyChart2", {
                    type: "bar",
                    data: {
                        labels: _chartLabels,
                        datasets: [{
                            backgroundColor: barColor,
                            data: _chartData
                        }]
                    }
                });
            },
            error: OnError
        });

        function OnError(err) {
            console.error(err);
        }
    });
</script>
